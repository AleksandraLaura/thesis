#Fastq to fasta
gunzip euksim.fastq.gz
seqret -sequence euksim.fastq -outseq euksim.fasta

#Blast database build
makeblastdb -in ../ref/library/merged_db.fa -parse_seqids -taxid_map ../ref/seqid2taxid.map -dbtype nucl -title blastdb

#Blast run
blastn -db ../ref/library/merged_db.fa -num_threads 1 -query euksim.fasta -out output_blastn  -max_target_seqs 500 -outfmt "6 std staxids"

#PIA
perl PIA.pl -f euksim.fasta -b output_blastn

#Count the number of True Positives
grep target_readID euksim.Summary_Reads.txt | grep 'Target' | wc -l

#False positives:
grep -v target_readID euksim.Summary_Reads.txt | grep 'Target' | wc -l

#False negatives:
grep target_readID euksim.Summary_Reads.txt | grep -v 'Target' | wc -l
