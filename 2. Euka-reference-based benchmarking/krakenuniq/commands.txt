#Database build
krakenuniq-build --db ../ref --kmer-len 31 --threads 10  --taxids-for-genomes --taxids-for-sequences --jellyfish-bin /path/to/apps/conda/krakenuniq-1.0.3/bin/jellyfish

#Run krakenuniq
krakenuniq --db ../ref  --report-file output.report.krakenuniq.tsv --output output.krakenuniq euksim.fastq.gz

#Get only the classified output
grep '^C' output.krakenuniq > output.classified.krakenuniq

#Translate
kraken-translate --db ../ref output.classified.krakenuniq > output.labels

#Get only the last two for species and genus extraction (easier filtering)
awk -F'\t' '{split($2,a,";"); print $1"\t"a[length(a)-1]";"a[length(a)]}' output.labels > output.shortended.labels
