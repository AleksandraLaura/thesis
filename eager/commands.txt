#nf-core/eager run
nextflow run nf-core/eager \
		 -r 2.4.4 \
		 -profile mjolnir_globe \
		 --input euksim_eager.tsv \
		 -c /home/wmj412/data/wmj412.aleks/caribbean_calculus/eager/custom.config \
		 --fasta /projects/mjolnir1/data/genomes/human/hg38.BROAD.fasta \
		 --seq_dict /projects/mjolnir1/data/genomes/human/hg38.BROAD.dict \
		 --fasta_index /projects/mjolnir1/data/genomes/human/hg38.BROAD.fasta.fai \
		 --bwa_index /projects/mjolnir1/data/genomes/human/ \
		 -name euksim \
		 --complexity_filter_poly_g \
		 --bam_unmapped_type fastq \
		 --bam_mapping_quality_threshold 20 \
		 --run_bam_filtering \
		 -with-tower

#Count false negatives after the eager run:
zcat euksim.unmapped.fastq.gz| grep _hg38 | wc -l

#Count false positives from the eager run:
samtools view euksim.filtered.bam | grep _hg38 -v | wc -l


#Get the counts of the different false positives
samtools view euksim.filtered.bam | grep hg38 -v | cut -f 1 | cut -d ':' -f 1 | sort | uniq -c
